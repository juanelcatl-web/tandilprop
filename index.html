<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TandilProp v28 - Total Fix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100vh; width: 100vw; overflow: hidden; font-family: sans-serif; }
        
        /* Contenedores de Vista */
        .view { position: fixed; inset: 0; display: none; background: white; z-index: 10; }
        .view.active { display: block; }
        
        /* Mapa ocupa todo el fondo */
        #map { width: 100vw; height: 100vh; position: absolute; z-index: 5; }

        /* HEADER FLOTANTE */
        header { 
            position: fixed; top: 10px; left: 10px; right: 10px; 
            background: white; border-radius: 20px; padding: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); z-index: 1000;
        }

        /* NAVEGACI√ìN FLOTANTE (ESTO NO FALLA) */
        nav {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: #1e293b; display: flex; padding: 5px; border-radius: 50px;
            z-index: 999999; box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            width: 80%; max-width: 300px;
        }
        .nav-btn {
            flex: 1; padding: 12px; border-radius: 40px; color: white;
            text-align: center; font-size: 11px; font-weight: 900; text-transform: uppercase;
        }
        .nav-btn.active { background: #4f46e5; }

        /* Bot√≥n de Confirmar Ubicaci√≥n */
        #btn-confirm {
            position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%);
            background: #4f46e5; color: white; padding: 16px 30px; border-radius: 20px;
            font-weight: 900; z-index: 2000; display: none; border: 3px solid white;
        }

        /* Pins */
        .leaflet-marker-icon { filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .pin-casa { filter: hue-rotate(0deg) !important; }
        .pin-depto { filter: hue-rotate(145deg) !important; }
        .pin-terreno { filter: hue-rotate(85deg) saturate(2) !important; }
        .pin-nuevo { filter: hue-rotate(240deg) brightness(1.2) !important; }

        #video-overlay { position: fixed; inset: 0; background: black; z-index: 2000000; display: none; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="video-overlay">
    <video id="transition-video" muted playsinline style="width:100%; height:100%; object-fit:cover;">
        <source src="https://assets.mixkit.co/videos/preview/mixkit-modern-apartment-complex-buildings-at-sunset-15437-large.mp4" type="video/mp4">
    </video>
    <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
        <h2 class="text-white text-2xl font-black italic">TANDILPROP</h2>
    </div>
</div>

<header>
    <div class="flex justify-between items-center mb-2 px-2">
        <h1 class="text-lg font-black text-indigo-600 italic">TANDILPROP</h1>
        <span class="text-[8px] bg-slate-100 p-1 rounded font-bold">V28 STABLE</span>
    </div>
    <div class="flex gap-2">
        <select id="f-type" onchange="loadData()" class="flex-1 p-2 bg-slate-50 border-none rounded-lg text-[10px] font-bold outline-none">
            <option value="todos">TIPO: TODOS</option>
            <option value="casa">üè† CASAS</option>
            <option value="depto">üè¢ DEPTOS</option>
            <option value="terreno">üå≥ TERRENOS</option>
        </select>
        <select id="f-op" onchange="loadData()" class="flex-1 p-2 bg-indigo-50 text-indigo-600 border-none rounded-lg text-[10px] font-bold outline-none">
            <option value="todos">OPERACI√ìN</option>
            <option value="venta">VENTA</option>
            <option value="alquiler">ALQUILER</option>
        </select>
    </div>
</header>

<div id="v-map" class="view active">
    <div id="map"></div>
    <button id="btn-confirm" onclick="openForm()">üìç CONFIRMAR AQU√ç</button>
</div>

<div id="v-list" class="view overflow-y-auto p-4 pt-32 pb-32">
    <div id="l-container" class="space-y-4"></div>
</div>

<div id="v-form" class="view overflow-y-auto p-6 pt-10">
    <h2 class="text-2xl font-black italic mb-6">PUBLICAR</h2>
    <div class="space-y-4 pb-20">
        <input type="text" id="p-title" placeholder="T√≠tulo" class="w-full p-4 bg-slate-100 rounded-xl font-bold">
        <div class="flex gap-2">
            <select id="p-type" class="flex-1 p-4 bg-slate-100 rounded-xl font-bold"><option value="casa">Casa</option><option value="depto">Depto</option><option value="terreno">Terreno</option></select>
            <select id="p-op" class="flex-1 p-4 bg-slate-100 rounded-xl font-bold text-indigo-600"><option value="venta">Venta</option><option value="alquiler">Alquiler</option></select>
        </div>
        <input type="text" id="p-address" placeholder="Direcci√≥n" class="w-full p-4 bg-indigo-50 rounded-xl font-bold outline-none border-2 border-indigo-200">
        <input type="number" id="p-price" placeholder="U$D Precio" class="w-full p-4 bg-slate-100 rounded-xl font-bold">
        <input type="text" id="p-wa" placeholder="WhatsApp (Ej: 2494112233)" class="w-full p-4 bg-slate-100 rounded-xl font-bold">
        <input type="text" id="p-img" placeholder="Link de Foto" class="w-full p-4 bg-slate-100 rounded-xl">
        <button onclick="saveProp()" class="w-full bg-indigo-600 text-white py-5 rounded-2xl font-black uppercase shadow-lg">Publicar Ahora
